a=5
log.posterior.mu <- function(mu,sigma2,mu0,tau2,y)
sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + dgamma(mu,a, a/mu0,log=TRUE)
log.posterior.sigma2 <- function(sigma2,mu,alpha,beta,y) {
if (sigma2<0) return(-Inf) else
return(sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + log(dgamma(sigma2,alpha,beta)))
}
y <- aqi #data
df1 = read.csv("C:/Users/ddinh4/Documents/EXST 7151/Final Project/Data/data_date.csv")
unique_data <- df1 %>% distinct(Country, .keep_all = TRUE)
library(ggplot2)
library(dplyr)
library(MCMCpack)
library(msm)
library(psych)
df1 = read.csv("C:/Users/ddinh4/Documents/EXST 7151/Final Project/Data/data_date.csv")
unique_data <- df1 %>% distinct(Country, .keep_all = TRUE)
aqi_2 <- unique_data[,c("Status","AQI_Value")]
aqi <- aqi_2[,2]
aqi <-  aqi[aqi <= 500]
aqi_df <- data.frame(aqi)
a=5
log.posterior.mu <- function(mu,sigma2,mu0,tau2,y)
sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + dgamma(mu,a, a/mu0,log=TRUE)
log.posterior.sigma2 <- function(sigma2,mu,alpha,beta,y) {
if (sigma2<0) return(-Inf) else
return(sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + log(dgamma(sigma2,alpha,beta)))
}
y <- aqi #data
## prior hyperparameters
mu0 <- 70
tau2 <- (70^2)/5
alpha <- 0.1
beta <- 0.1
sigma2 <- var(aqi) # initial value for sigma2
mu<- mean(aqi) # initial value for mu
n.sim<-10000 ; mu.mcmc<-NULL ; sigma2.mcmc <- NULL; accept.mu <- 0;accept.sigma2 <- 0
delta1 <- 60 ; ## normal proposal var for mu
delta2 <- 30000 ## normal proposal var for sigma2
for ( ite in 1 : n.sim) {
mu.star<-rnorm(1, mu, sqrt(delta1))
log.r <- log.posterior.mu(mu.star,sigma2,mu0,tau2,y) - log.posterior.mu(mu,sigma2,mu0,tau2,y)
if (log(runif(1))< log.r) {
mu <- mu.star
accept.mu <- accept.mu+1
}
mu.mcmc<-c(mu.mcmc, mu)
sigma2.star<-rnorm(1, sigma2, sqrt(delta2) )
log.r <- log.posterior.sigma2(sigma2.star,mu,alpha,beta,y) - log.posterior.sigma2(sigma2,mu,alpha,beta,y)
if (log(runif(1))< log.r) {
sigma2 <- sigma2.star
accept.sigma2 <- accept.sigma2+1
}
sigma2.mcmc<-c(sigma2.mcmc, sigma2)
}
par(mfrow=c(2,1))
plot(mu.mcmc,type='l')
plot(sigma2.mcmc,type='l')
a=5
log.posterior.mu <- function(mu,sigma2,mu0,tau2,y)
sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + dgamma(mu,a, a/mu0,log=TRUE)
log.posterior.sigma2 <- function(sigma2,mu,alpha,beta,y) {
if (sigma2<0) return(-Inf) else
return(sum(dnorm(y, mu, sqrt(sigma2), log=TRUE)) + log(dgamma(sigma2,alpha,beta)))
}
y <- aqi #data
## prior hyperparameters
mu0 <- 70
tau2 <- (70^2)/5
alpha <- 0.1
beta <- 0.1
sigma2 <- var(aqi) # initial value for sigma2
mu<- mean(aqi) # initial value for mu
n.sim<-10000 ; mu.mcmc<-NULL ; sigma2.mcmc <- NULL; accept.mu <- 0;accept.sigma2 <- 0
delta1 <- 60 ; ## normal proposal var for mu
delta2 <- 30000 ## normal proposal var for sigma2
for ( ite in 1 : n.sim) {
mu.star<-rtnorm(1, mu, sqrt(delta1), 0, 500)
log.r <- log.posterior.mu(mu.star,sigma2,mu0,tau2,y) + dtnorm(mu, mu.star, sqrt(delta1), 0,500, log = T) - log.posterior.mu(mu,sigma2,mu0,tau2,y) - dtnorm(mu.star, mu, sqrt(delta1), 0,500, log = T)
if (log(runif(1))< log.r) {
mu <- mu.star
accept.mu <- accept.mu+1
}
mu.mcmc<-c(mu.mcmc, mu)
sigma2.star<-rtnorm(1, sigma2, sqrt(delta2),0, Inf)
log.r <- log.posterior.sigma2(sigma2.star,mu,alpha,beta,y) + dtnorm(sigma2,sigma2.star,sqrt(delta2),0,Inf,log=T) - log.posterior.sigma2(sigma2,mu,alpha,beta,y) - dtnorm(sigma2.star,sigma2,sqrt(delta2),0,Inf,log=T)
if (log(runif(1))< log.r) {
sigma2 <- sigma2.star
accept.sigma2 <- accept.sigma2+1
}
sigma2.mcmc<-c(sigma2.mcmc, sigma2)
}
par(mfrow=c(2,1))
plot(mu.mcmc,type='l')
plot(sigma2.mcmc,type='l')
print(paste("Acceptance rate of mu =", accept.mu/n.sim))
print(paste("Acceptance rate of sigma2 =", accept.sigma2/n.sim))
print(paste("Mean of mu =" ,mean(mu.mcmc[2000:10000])))
print(paste("Mean of sigma2 =", mean(sigma2.mcmc[2000:10000])))
print(paste("Variance of mu =", var(mu.mcmc[2000:10000])))
print(paste("Variance of sigma2 =", var(sigma2.mcmc[2000:10000])))
prior.prob.h0 = pgamma(100, a, a/mu0)
prior.prob.h1 = 1 - prior.prob.h0
prior.odds = prior.prob.h0/prior.prob.h1
sum(mu.mcmc[2000:10000] > 100)/length(mu.mcmc[2000:10000])
sum(mu.mcmc[2000:10000] > 100)
mu = mean(mu.mcmc[2000:10000])
sum(mu.mcmc[2000:10000] > 100)
mu_mcmc=mu.mcmc[2000:10000
sum(] > 100)
mu_mcmc=mu.mcmc[2000:10000]
sum(mu_mcmc > 100)
sum(mu_mcmc < 100)
sum(mu_mcmc < 100)/length(mu_mcmc)
sum(mu_mcmc < 50)
sum(mu_mcmc > 50)
sum(mu_mcmc > 63)
sum(mu_mcmc > 63)/length(mu_mcmc)
sum(mu_mcmc > 60)/length(mu_mcmc)
h0=sum(mu_mcmc < 60)/length(mu_mcmc)
h1 = 1 - h0
po = h0/h1
prior.prob.h0 = pgamma(100, a, a/mu0)
prior.prob.h1 = 1 - prior.prob.h0
prior.odds = prior.prob.h0/prior.prob.h1
BF = po/prior.odds
h0=sum(mu_mcmc < 100)/length(mu_mcmc)
h1 = 1 - h0
po = h0/h1
BF = po/prior.odds
po.h0=sum(mu_mcmc > 60)/length(mu_mcmc)
po.h1 = 1-po.h0
range(mu_mcmc)
library(readxl)
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls)
gc()
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls)
library(readxl)
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls)
library(readxl)
library(readxl)
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls)
library(readxl)
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls)
df1
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls")
library(readxl)
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls")
df1 = read_excel("C:/Users/ddinh4/Documents/ECON 7629/Textbook/Excel Sets/rental.xls", col_names = F)
df1 = df1[,c(10,11,14,21)]
colnames(df1) <- c("lpop", "lrent", "lavginc", "pctstu")
knitr::opts_chunk$set(echo = TRUE)
sum.grid08 = mean(gridid.08)
sum.grid08 = describe(gridid.08)
library(easypackages)
libraries("tidyverse","boot","randomForest","psych","AUC","MASS","car",
"viridis","caret","ggplot2", "corrplot", "gridExtra", "mlbench", "neuralnet")
df1 = read.csv("C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/YY_varying_withGrid_withoutSurrounding_06_25.csv")
df1 <- df1[, -which(names(df1) %in% c("fid", "field_1","X", "x", "y", "Application_4_N_rate", "Application_5_N_rate"))]
df1 <- df1 %>%
drop_na()  %>%
mutate(GridId = as.factor(GridId)) %>%
mutate(row = as.numeric(row)) %>%
mutate(col = as.numeric(col))
gridid_subsets <- split(df1, df1$GridId)
gridid.08 = gridid_subsets$`8`
gridid.09 = gridid_subsets$`9`
gridid.10 = gridid_subsets$`10`
gridid.11 = gridid_subsets$`11`
gridid.19 = gridid_subsets$`19`
gridid.20 = gridid_subsets$`20`
gridid.21 = gridid_subsets$`21`
gridid.22 = gridid_subsets$`22`
gridid.30 = gridid_subsets$`30`
gridid.31 = gridid_subsets$`31`
gridid.32 = gridid_subsets$`32`
gridid.33 = gridid_subsets$`33`
gridid.41 = gridid_subsets$`41`
gridid.42 = gridid_subsets$`42`
gridid.43 = gridid_subsets$`43`
gridid.44 = gridid_subsets$`44`
gridid.52 = gridid_subsets$`52`
gridid.53 = gridid_subsets$`53`
gridid.54 = gridid_subsets$`54`
gridid.55 = gridid_subsets$`55`
sum.grid08 = describe(gridid.08)
sum.grid09 = describe(gridid.09)
sum.grid08 = mean(gridid.08)
View(gridid.08)
sum.grid08 = describe(gridid.08)
View(sum.grid08)
knitr::opts_chunk$set(echo = TRUE)
sum.grid08 = describe.by(gridid.08)
View(sum.grid08)
sum.grid08 = describe(gridid.08)
View(sum.grid08)
sum.grid08 = describe(gridid.08)$mean
sum.grid08 = colMeans(gridid.08)
View(gridid.08)
sum.grid08 = colMeans(gridid.08[-1,])
sum.grid08 = colMeans(gridid.08[,-1])
sum.grid08 = describe(gridid.08)
sum.grid08 = describe(gridid.08)$means; variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Mean = sum.grid08)
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Mean = sum.grid08$mean)
View(result_grid08)
View(sum.grid08)
View(result_grid08)
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Mean = sum.grid08$mean)
sum.grid09 = describe(gridid.09); variable_names <- rownames(sum.grid09);
result_grid09 <- data.frame(Variable = variable_names, Mean = sum.grid09$mean)
sum.grid10 = describe(gridid.10); variable_names <- rownames(sum.grid10);
result_grid10 <- data.frame(Variable = variable_names, Mean = sum.grid10$mean)
sum.grid11 = describe(gridid.11); variable_names <- rownames(sum.grid11);
result_grid11 <- data.frame(Variable = variable_names, Mean = sum.grid11$mean)
sum.grid19 = describe(gridid.19); variable_names <- rownames(sum.grid19);
result_grid19 <- data.frame(Variable = variable_names, Mean = sum.grid19$mean)
sum.grid20 = describe(gridid.20); variable_names <- rownames(sum.grid20);
result_grid20 <- data.frame(Variable = variable_names, Mean = sum.grid20$mean)
sum.grid21 = describe(gridid.21); variable_names <- rownames(sum.grid21);
result_grid21 <- data.frame(Variable = variable_names, Mean = sum.gri21$mean)
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Mean = sum.grid08$mean)
sum.grid09 = describe(gridid.09); variable_names <- rownames(sum.grid09);
result_grid09 <- data.frame(Variable = variable_names, Mean = sum.grid09$mean)
sum.grid10 = describe(gridid.10); variable_names <- rownames(sum.grid10);
result_grid10 <- data.frame(Variable = variable_names, Mean = sum.grid10$mean)
sum.grid11 = describe(gridid.11); variable_names <- rownames(sum.grid11);
result_grid11 <- data.frame(Variable = variable_names, Mean = sum.grid11$mean)
sum.grid19 = describe(gridid.19); variable_names <- rownames(sum.grid19);
result_grid19 <- data.frame(Variable = variable_names, Mean = sum.grid19$mean)
sum.grid20 = describe(gridid.20); variable_names <- rownames(sum.grid20);
result_grid20 <- data.frame(Variable = variable_names, Mean = sum.grid20$mean)
sum.grid21 = describe(gridid.21); variable_names <- rownames(sum.grid21);
result_grid21 <- data.frame(Variable = variable_names, Mean = sum.grid21$mean)
sum.grid22 = describe(gridid.22); variable_names <- rownames(sum.grid22);
result_grid22 <- data.frame(Variable = variable_names, Mean = sum.grid22$mean)
sum.grid30 = describe(gridid.30); variable_names <- rownames(sum.grid30);
result_grid30 <- data.frame(Variable = variable_names, Mean = sum.grid30$mean)
sum.grid31 = describe(gridid.31); variable_names <- rownames(sum.grid31);
result_grid31 <- data.frame(Variable = variable_names, Mean = sum.grid31$mean)
sum.grid32 = describe(gridid.32); variable_names <- rownames(sum.grid32);
result_grid32 <- data.frame(Variable = variable_names, Mean = sum.grid32$mean)
sum.grid33 = describe(gridid.33); variable_names <- rownames(sum.grid33);
result_grid33 <- data.frame(Variable = variable_names, Mean = sum.grid33$mean)
sum.grid41 = describe(gridid.41); variable_names <- rownames(sum.grid41);
result_grid41 <- data.frame(Variable = variable_names, Mean = sum.grid41$mean)
sum.grid42 = describe(gridid.42); variable_names <- rownames(sum.grid42);
result_grid42 <- data.frame(Variable = variable_names, Mean = sum.grid42$mean)
sum.grid43 = describe(gridid.43); variable_names <- rownames(sum.grid43);
result_grid43 <- data.frame(Variable = variable_names, Mean = sum.grid43$mean)
sum.grid44 = describe(gridid.44); variable_names <- rownames(sum.grid44);
result_grid44 <- data.frame(Variable = variable_names, Mean = sum.grid44$mean)
sum.grid52 = describe(gridid.52); variable_names <- rownames(sum.grid52);
result_grid52 <- data.frame(Variable = variable_names, Mean = sum.grid52$mean)
sum.grid53 = describe(gridid.53); variable_names <- rownames(sum.grid53);
result_grid53 <- data.frame(Variable = variable_names, Mean = sum.grid53$mean)
sum.grid54 = describe(gridid.54); variable_names <- rownames(sum.grid54);
result_grid54 <- data.frame(Variable = variable_names, Mean = sum.grid54$mean)
sum.grid55 = describe(gridid.55); variable_names <- rownames(sum.grid55);
result_grid55 <- data.frame(Variable = variable_names, Mean = sum.grid55$mean)
View(result_grid55)
View(result_grid33)
df2 = cbind(result_grid08,result_grid09)
View(df2)
df2 = cbind(result_grid08,result_grid09[,2])
View(df2)
df2 = cbind(result_grid08,result_grid09[,2],result_grid10[,2],result_grid11[,2],result_grid19[,2],result_grid20[,2],result_grid21[,2],result_grid22[,2],result_grid30[,2],result_grid31[,2],result_grid32[,2],result_grid33[,2],result_grid41[,2],result_grid42[,2],result_grid43[,2],result_grid44[,2],result_grid52[,2],result_grid53[,2],result_grid54[,2],result_grid55[,2])
View(df2)
View(sum.grid22)
write.csv(df2, "Grid_Comparison.csv", row.names = TRUE)
setwd("~/Fall 2023/EXST 7142/EXST 7142 Final Project/Code")
write.csv(df2, "../EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, "/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, ".../EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = F)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = FALSE)
TRUE
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = TRUE)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Comparison.csv", row.names = F)
write.csv(df2, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Mean_Comparison.csv", row.names = F)
column_index <- which(names(df1) == "VRYieldVOl")
# Move the column to be the first column
df1 <- df1[, c(column_index, setdiff(1:ncol(df1), column_index))]
N = nrow(df1)
column_index <- which(names(df1) == "VRYieldVOl")
# Move the column to be the first column
df1 <- df1[, c(column_index, setdiff(1:ncol(df1), column_index))]
N = nrow(df1)
set.seed(123)
index <- sample(1:N, size = N*.8, replace = F)
train_x <- df1[index, 2:17]
test_x <- df1[-index, 2:17]
train_y <- df1[index, 1]
test_y <- df1[-index, 1]
train <- df1[index,]
test <- df1[-index,]
lm.fit = lm(VRYieldVOl~., data = train)
summary(lm.fit)
vif(lm.fit)
summary(lm.fit)
pred1 = predict(lm.fit, newdata = test)
cor(pred1, train$VRYieldVOl)
cor(pred1, test$VRYieldVOl)
r.square1 = 1-sum((test$VRYieldVOl-pred1)^2)/sum((test$VRYieldVOl-mean(test$VRYieldVOl))^2)
lm.fit2 = stepAIC(lm.fit, direction = "both")
pred2 = predict(lm.fit2, newdata = test)
cor2 = cor(pred2, test$VRYieldVOl)
r.square2 = 1-sum((test$VRYieldVOl-pred2)^2)/sum((test$VRYieldVOl-mean(test$VRYieldVOl))^2)
summary(lm.fit2)
plot(lm.fit2)
par(mfrow=c(2,2))
plot(lm.fit2)
a = 0.005*max(df1$VRYieldVOl)
k <- seq(from = 20, to = 90, by = 1)
h <- length(k)
p.value <- vector(mode = "numeric", length = h)
for (i in 1:h) {
set.seed(1)
subset_condition <- df1$VRYieldVOl >= k[i] * a
df2 <- df1[subset_condition, ]
p.value[i] <- shapiro.test(df2$VRYieldVOl)$p.value
}
optimal.k <- k[which.max(p.value)]
plot(k, p.value, type = "b", xlab = "Number of k", ylab = "p-value")
df1 = df1[df1$VRYieldVOl >= optimal.k*a,]
shapiro.test(df1$VRYieldVOl)
ggplot(df1, aes(x = VRYieldVOl)) +
geom_histogram(binwidth = 4, aes(y = ..count..)) +
labs(x = "Yield", y = "Frequency")
gridid_subsets <- split(df1, df1$GridId)
gridid.08 = gridid_subsets$`8`
gridid.09 = gridid_subsets$`9`
gridid.10 = gridid_subsets$`10`
gridid.11 = gridid_subsets$`11`
gridid.19 = gridid_subsets$`19`
gridid.20 = gridid_subsets$`20`
gridid.21 = gridid_subsets$`21`
gridid.22 = gridid_subsets$`22`
gridid.30 = gridid_subsets$`30`
gridid.31 = gridid_subsets$`31`
gridid.32 = gridid_subsets$`32`
gridid.33 = gridid_subsets$`33`
gridid.41 = gridid_subsets$`41`
gridid.42 = gridid_subsets$`42`
gridid.43 = gridid_subsets$`43`
gridid.44 = gridid_subsets$`44`
gridid.52 = gridid_subsets$`52`
gridid.53 = gridid_subsets$`53`
gridid.54 = gridid_subsets$`54`
gridid.55 = gridid_subsets$`55`
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Mean = sum.grid08$mean)
sum.grid09 = describe(gridid.09); variable_names <- rownames(sum.grid09);
result_grid09 <- data.frame(Variable = variable_names, Mean = sum.grid09$mean)
sum.grid10 = describe(gridid.10); variable_names <- rownames(sum.grid10);
result_grid10 <- data.frame(Variable = variable_names, Mean = sum.grid10$mean)
sum.grid11 = describe(gridid.11); variable_names <- rownames(sum.grid11);
result_grid11 <- data.frame(Variable = variable_names, Mean = sum.grid11$mean)
sum.grid19 = describe(gridid.19); variable_names <- rownames(sum.grid19);
result_grid19 <- data.frame(Variable = variable_names, Mean = sum.grid19$mean)
sum.grid20 = describe(gridid.20); variable_names <- rownames(sum.grid20);
result_grid20 <- data.frame(Variable = variable_names, Mean = sum.grid20$mean)
sum.grid21 = describe(gridid.21); variable_names <- rownames(sum.grid21);
result_grid21 <- data.frame(Variable = variable_names, Mean = sum.grid21$mean)
sum.grid22 = describe(gridid.22); variable_names <- rownames(sum.grid22);
result_grid22 <- data.frame(Variable = variable_names, Mean = sum.grid22$mean)
sum.grid30 = describe(gridid.30); variable_names <- rownames(sum.grid30);
result_grid30 <- data.frame(Variable = variable_names, Mean = sum.grid30$mean)
sum.grid31 = describe(gridid.31); variable_names <- rownames(sum.grid31);
result_grid31 <- data.frame(Variable = variable_names, Mean = sum.grid31$mean)
sum.grid32 = describe(gridid.32); variable_names <- rownames(sum.grid32);
result_grid32 <- data.frame(Variable = variable_names, Mean = sum.grid32$mean)
sum.grid33 = describe(gridid.33); variable_names <- rownames(sum.grid33);
result_grid33 <- data.frame(Variable = variable_names, Mean = sum.grid33$mean)
sum.grid41 = describe(gridid.41); variable_names <- rownames(sum.grid41);
result_grid41 <- data.frame(Variable = variable_names, Mean = sum.grid41$mean)
sum.grid42 = describe(gridid.42); variable_names <- rownames(sum.grid42);
result_grid42 <- data.frame(Variable = variable_names, Mean = sum.grid42$mean)
sum.grid43 = describe(gridid.43); variable_names <- rownames(sum.grid43);
result_grid43 <- data.frame(Variable = variable_names, Mean = sum.grid43$mean)
sum.grid44 = describe(gridid.44); variable_names <- rownames(sum.grid44);
result_grid44 <- data.frame(Variable = variable_names, Mean = sum.grid44$mean)
sum.grid52 = describe(gridid.52); variable_names <- rownames(sum.grid52);
result_grid52 <- data.frame(Variable = variable_names, Mean = sum.grid52$mean)
sum.grid53 = describe(gridid.53); variable_names <- rownames(sum.grid53);
result_grid53 <- data.frame(Variable = variable_names, Mean = sum.grid53$mean)
sum.grid54 = describe(gridid.54); variable_names <- rownames(sum.grid54);
result_grid54 <- data.frame(Variable = variable_names, Mean = sum.grid54$mean)
sum.grid55 = describe(gridid.55); variable_names <- rownames(sum.grid55);
result_grid55 <- data.frame(Variable = variable_names, Mean = sum.grid55$mean)
df3 = cbind(result_grid08,result_grid09[,2],result_grid10[,2],result_grid11[,2],result_grid19[,2],result_grid20[,2],result_grid21[,2],result_grid22[,2],result_grid30[,2],result_grid31[,2],result_grid32[,2],result_grid33[,2],result_grid41[,2],result_grid42[,2],result_grid43[,2],result_grid44[,2],result_grid52[,2],result_grid53[,2],result_grid54[,2],result_grid55[,2])
write.csv(df3, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Mean_Comparison.csv", row.names = F)
write.csv(df3, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Mean_Comparison.csv", row.names = F)
column_index <- which(names(df1) == "VRYieldVOl")
# Move the column to be the first column
df1 <- df1[, c(column_index, setdiff(1:ncol(df1), column_index))]
N = nrow(df1)
set.seed(123)
index <- sample(1:N, size = N*.8, replace = F)
train_x <- df1[index, 2:17]
test_x <- df1[-index, 2:17]
train_y <- df1[index, 1]
test_y <- df1[-index, 1]
train <- df1[index,]
test <- df1[-index,]
lm.fit = lm(VRYieldVOl~., data = train)
summary(lm.fit)
pred1 = predict(lm.fit, newdata = test)
cor1 = cor(pred1, test$VRYieldVOl)
r.square1 = 1-sum((test$VRYieldVOl-pred1)^2)/sum((test$VRYieldVOl-mean(test$VRYieldVOl))^2)
lm.fit2 = stepAIC(lm.fit, direction = "both")
pred2 = predict(lm.fit2, newdata = test)
cor2 = cor(pred2, test$VRYieldVOl)
r.square2 = 1-sum((test$VRYieldVOl-pred2)^2)/sum((test$VRYieldVOl-mean(test$VRYieldVOl))^2)
par(mfrow=c(2,2))
plot(lm.fit2)
summary(lm.fit2)
lm.fit2 = stepAIC(lm.fit, direction = "both")
pred2 = predict(lm.fit2, newdata = test)
summary(lm.fit2)
cor2 = cor(pred2, test$VRYieldVOl)
r.square2 = 1-sum((test$VRYieldVOl-pred2)^2)/sum((test$VRYieldVOl-mean(test$VRYieldVOl))^2)
par(mfrow=c(2,2))
plot(lm.fit2)
ggplot(df1, aes(x = VRYieldVOl)) +
geom_histogram(binwidth = 3, aes(y = ..density..)) +
facet_wrap(~GridId, scales = "free") +
labs(x = "Yield", y = "Frequency") +
theme_classic()
install.packages("rpart")
install.packages("rpart")
library(rpart)
knitr::opts_chunk$set(echo = TRUE)
col_df = df1[df1$col <= 45,]
col_df = col_df[col_df$col >= 25,]
col_df = col_df[,-4]
G = nrow(col_df)
index3 <- sample(1:G, size = G*.8, replace = F)
train_x3 <- col_df[index3, 2:16]
test_x3 <- col_df[-index3, 2:16]
train_y3 <- col_df[index3, 1]
test_y3 <- col_df[-index3, 1]
train3 <- col_df[index3,]
test3 <- col_df[-index3,]
lm.fit = lm(VRYieldVOl~., data = train3)
summary(lm.fit)
pred1 = predict(lm.fit, newdata = test3)
cor1 = cor(pred1, test3$VRYieldVOl)
r.square1 = 1-sum((test3$VRYieldVOl-pred1)^2)/sum((test3$VRYieldVOl-mean(test3$VRYieldVOl))^2)
par(mfrow=c(4,4), mar = c(4,4,1,1))
for (j in 1:16){
x = col_df[,j]
plot(x,col_df$VRYieldVOl, xlab = names(col_df)[j], ylab= "VRYieldVOl")
lines(lowess(col_df$VRYieldVOl~x), col = "blue")
abline(lm(col_df$VRYieldVOl~x), col = "red")
}
View(sum.grid42)
View(sum.grid43)
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
library(easypackages)
libraries("tidyverse","boot","randomForest","psych","AUC","MASS","car",
"viridis","caret","ggplot2", "corrplot", "gridExtra", "mlbench", "neuralnet",
"rpart")
sum.grid08 = describe(gridid.08); variable_names <- rownames(sum.grid08);
result_grid08 <- data.frame(Variable = variable_names, Median = sum.grid08$median)
sum.grid09 = describe(gridid.09); variable_names <- rownames(sum.grid09);
result_grid09 <- data.frame(Variable = variable_names, Median = sum.grid09$median)
sum.grid10 = describe(gridid.10); variable_names <- rownames(sum.grid10);
result_grid10 <- data.frame(Variable = variable_names, Median = sum.grid10$median)
sum.grid11 = describe(gridid.11); variable_names <- rownames(sum.grid11);
result_grid11 <- data.frame(Variable = variable_names, Median = sum.grid11$median)
sum.grid19 = describe(gridid.19); variable_names <- rownames(sum.grid19);
result_grid19 <- data.frame(Variable = variable_names, Median = sum.grid19$median)
sum.grid20 = describe(gridid.20); variable_names <- rownames(sum.grid20);
result_grid20 <- data.frame(Variable = variable_names, Median = sum.grid20$median)
sum.grid21 = describe(gridid.21); variable_names <- rownames(sum.grid21);
result_grid21 <- data.frame(Variable = variable_names, Median = sum.grid21$median)
sum.grid22 = describe(gridid.22); variable_names <- rownames(sum.grid22);
result_grid22 <- data.frame(Variable = variable_names, Median = sum.grid22$median)
sum.grid30 = describe(gridid.30); variable_names <- rownames(sum.grid30);
result_grid30 <- data.frame(Variable = variable_names, Median = sum.grid30$median)
sum.grid31 = describe(gridid.31); variable_names <- rownames(sum.grid31);
result_grid31 <- data.frame(Variable = variable_names, Median = sum.grid31$median)
sum.grid32 = describe(gridid.32); variable_names <- rownames(sum.grid32);
result_grid32 <- data.frame(Variable = variable_names, Median = sum.grid32$median)
sum.grid33 = describe(gridid.33); variable_names <- rownames(sum.grid33);
result_grid33 <- data.frame(Variable = variable_names, Median = sum.grid33$median)
sum.grid41 = describe(gridid.41); variable_names <- rownames(sum.grid41);
result_grid41 <- data.frame(Variable = variable_names, Median = sum.grid41$median)
sum.grid42 = describe(gridid.42); variable_names <- rownames(sum.grid42);
result_grid42 <- data.frame(Variable = variable_names, Median = sum.grid42$median)
sum.grid43 = describe(gridid.43); variable_names <- rownames(sum.grid43);
result_grid43 <- data.frame(Variable = variable_names, Median = sum.grid43$median)
sum.grid44 = describe(gridid.44); variable_names <- rownames(sum.grid44);
result_grid44 <- data.frame(Variable = variable_names, Median = sum.grid44$median)
sum.grid52 = describe(gridid.52); variable_names <- rownames(sum.grid52);
result_grid52 <- data.frame(Variable = variable_names, Median = sum.grid52$median)
sum.grid53 = describe(gridid.53); variable_names <- rownames(sum.grid53);
result_grid53 <- data.frame(Variable = variable_names, Median = sum.grid53$median)
sum.grid54 = describe(gridid.54); variable_names <- rownames(sum.grid54);
result_grid54 <- data.frame(Variable = variable_names, Median = sum.grid54$median)
sum.grid55 = describe(gridid.55); variable_names <- rownames(sum.grid55);
result_grid55 <- data.frame(Variable = variable_names, Median = sum.grid55$median)
View(sum.grid33)
View(result_grid08)
df3 = cbind(result_grid08,result_grid09[,2],result_grid10[,2],result_grid11[,2],result_grid19[,2],result_grid20[,2],result_grid21[,2],result_grid22[,2],result_grid30[,2],result_grid31[,2],result_grid32[,2],result_grid33[,2],result_grid41[,2],result_grid42[,2],result_grid43[,2],result_grid44[,2],result_grid52[,2],result_grid53[,2],result_grid54[,2],result_grid55[,2])
write.csv(df3, "C:/Users/ddinh4/Documents/Fall 2023/EXST 7142/EXST 7142 Final Project/Data/Grid_Median_Comparison.csv", row.names = F)
